<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>加密解密工具</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- 引入CryptoJS库用于多种加密算法 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    
    <!-- Tailwind配置 -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#10B981',
                        dark: '#1E293B',
                        light: '#F8FAFC',
                        accent: '#8B5CF6'
                    },
                    fontFamily: {
                        inter: ['Inter', 'system-ui', 'sans-serif'],
                    }
                },
            }
        }
    </script>
    
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.1);
            }
            .transition-all-300 {
                transition: all 300ms ease-in-out;
            }
            .glass-effect {
                backdrop-filter: blur(10px);
                background-color: rgba(255, 255, 255, 0.7);
            }
            .glass-effect-dark {
                backdrop-filter: blur(10px);
                background-color: rgba(30, 41, 59, 0.7);
            }
        }
    </style>
</head>
<body class="font-inter bg-gradient-to-br from-light to-blue-50 min-h-screen text-dark transition-all-300">
    <!-- 顶部导航 -->
    <header class="sticky top-0 z-50 glass-effect border-b border-blue-100 shadow-sm transition-all-300">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <i class="fa fa-lock text-primary text-2xl"></i>
                <h1 class="text-xl md:text-2xl font-bold text-primary">加密解密工具</h1>
            </div>
            <div class="flex items-center space-x-4">
                <button id="theme-toggle" class="p-2 rounded-full hover:bg-gray-100 transition-all-300">
                    <i class="fa fa-moon-o text-gray-600"></i>
                </button>
                <button id="help-btn" class="flex items-center space-x-1 bg-primary/10 text-primary px-3 py-1.5 rounded-full text-sm hover:bg-primary/20 transition-all-300">
                    <i class="fa fa-question-circle"></i>
                    <span class="hidden md:inline">帮助</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8 md:py-12">
        <!-- 介绍部分 -->
        <section class="text-center mb-10 max-w-3xl mx-auto">
            <h2 class="text-[clamp(1.5rem,3vw,2.5rem)] font-bold mb-4 text-dark text-shadow transition-all-300">
                简单高效的加密解密解决方案
            </h2>
            <p class="text-gray-600 mb-6 text-lg transition-all-300">
                支持多种加密算法，保护您的敏感信息安全传输与存储
            </p>
            <div class="flex flex-wrap justify-center gap-4">
                <span class="px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm transition-all-300">Base64</span>
                <span class="px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm transition-all-300">URL编码</span>
                <span class="px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm transition-all-300">Unicode</span>
                <span class="px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm transition-all-300">ASCII</span>
                <span class="px-3 py-1 bg-red-100 text-red-800 rounded-full text-sm transition-all-300">ROT13</span>
                <span class="px-3 py-1 bg-indigo-100 text-indigo-800 rounded-full text-sm transition-all-300">HTML实体</span>
                <span class="px-3 py-1 bg-pink-100 text-pink-800 rounded-full text-sm transition-all-300">十六进制</span>
                <span class="px-3 py-1 bg-amber-100 text-amber-800 rounded-full text-sm transition-all-300">摩尔斯电码</span>
                <span class="px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm transition-all-300">MD5/SHA</span>
                <span class="px-3 py-1 bg-rose-100 text-rose-800 rounded-full text-sm transition-all-300">AES/DES</span>
                <span class="px-3 py-1 bg-emerald-100 text-emerald-800 rounded-full text-sm transition-all-300">古典密码</span>
                <span class="px-3 py-1 bg-sky-100 text-sky-800 rounded-full text-sm transition-all-300">HMAC</span>
            </div>
        </section>

        <!-- 主要功能区 -->
        <section class="max-w-5xl mx-auto">
            <div class="bg-white rounded-2xl shadow-xl overflow-hidden transform hover:shadow-2xl transition-all duration-300">
                <!-- 操作类型选择 -->
                <div class="flex border-b">
                    <button id="encrypt-btn" class="flex-1 py-4 px-6 font-medium text-primary border-b-2 border-primary transition-all-300">
                        <i class="fa fa-lock mr-2"></i>加密
                    </button>
                    <button id="decrypt-btn" class="flex-1 py-4 px-6 font-medium text-gray-500 hover:text-gray-700 transition-all-300">
                        <i class="fa fa-unlock mr-2"></i>解密
                    </button>
                </div>

                <!-- 算法选择 -->
                <div class="p-6 border-b overflow-x-auto">
                    <label class="block text-gray-700 mb-2 font-medium transition-all-300">选择算法:</label>
                    <div class="flex flex-wrap gap-3 min-w-max">
                        <!-- 基础编码 -->
                        <button class="algorithm-btn active px-3 py-2 border border-primary bg-primary/5 text-primary rounded-lg text-sm hover:bg-primary/10 transition-all-300" data-algorithm="base64">
                            Base64
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="url">
                            URL编码
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="unicode">
                            Unicode
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="ascii">
                            ASCII
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="html">
                            HTML实体
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="hex">
                            十六进制
                        </button>
                        
                        <!-- 古典密码 -->
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="rot13">
                            ROT13
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="caesar">
                            凯撒密码
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="affine">
                            仿射密码
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="vigenere">
                            维吉尼亚密码
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="morse">
                            摩尔斯电码
                        </button>
                        
                        <!-- 哈希算法 -->
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="md5">
                            MD5
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="sha1">
                            SHA-1
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="sha256">
                            SHA-256
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="sha512">
                            SHA-512
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="hmac">
                            HMAC
                        </button>
                        
                        <!-- 对称加密 -->
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="aes">
                            AES
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="des">
                            DES
                        </button>
                        <button class="algorithm-btn px-3 py-2 border border-gray-200 text-gray-700 rounded-lg text-sm hover:bg-gray-50 transition-all-300" data-algorithm="rc4">
                            RC4
                        </button>
                    </div>
                </div>

                <!-- 密钥/参数输入区 (某些算法需要) -->
                <div id="params-section" class="p-6 border-b hidden transition-all-300">
                    <div id="single-param" class="block">
                        <label id="param-label" class="block text-gray-700 mb-2 font-medium transition-all-300">
                            密钥:
                        </label>
                        <div class="relative">
                            <input id="param-input" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all-300" placeholder="请输入密钥或参数...">
                            <button id="toggle-visibility" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 transition-all-300">
                                <i class="fa fa-eye-slash"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div id="dual-params" class="hidden">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label id="param1-label" class="block text-gray-700 mb-2 font-medium transition-all-300">
                                    参数 A:
                                </label>
                                <input id="param1-input" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all-300" placeholder="请输入参数A...">
                            </div>
                            <div>
                                <label id="param2-label" class="block text-gray-700 mb-2 font-medium transition-all-300">
                                    参数 B:
                                </label>
                                <input id="param2-input" type="text" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all-300" placeholder="请输入参数B...">
                            </div>
                        </div>
                    </div>
                    
                    <p id="param-hint" class="mt-2 text-sm text-gray-500 transition-all-300">
                        请输入必要的密钥或参数
                    </p>
                </div>

                <!-- 输入输出区域 -->
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- 输入区域 -->
                        <div>
                            <label for="input-text" class="block text-gray-700 mb-2 font-medium transition-all-300">
                                <i class="fa fa-input mr-1"></i>输入内容:
                            </label>
                            <div class="relative">
                                <textarea id="input-text" class="w-full h-48 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all-300 resize-none" placeholder="请输入要加密/解密的文本..."></textarea>
                                <button id="clear-input" class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 transition-all-300">
                                    <i class="fa fa-times-circle"></i>
                                </button>
                            </div>
                            <div class="mt-2 text-right text-sm text-gray-500 transition-all-300">
                                <span id="input-length">0</span> 字符
                            </div>
                        </div>

                        <!-- 输出区域 -->
                        <div>
                            <label for="output-text" class="block text-gray-700 mb-2 font-medium transition-all-300">
                                <i class="fa fa-output mr-1"></i>结果:
                            </label>
                            <div class="relative">
                                <textarea id="output-text" class="w-full h-48 p-4 border border-gray-300 rounded-lg bg-gray-50 focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all-300 resize-none" placeholder="结果将显示在这里..." readonly=""></textarea>
                                <button id="copy-output" class="absolute top-3 right-3 text-gray-400 hover:text-primary transition-all-300">
                                    <i class="fa fa-copy"></i>
                                </button>
                            </div>
                            <div class="mt-2 text-right text-sm text-gray-500 transition-all-300">
                                <span id="output-length">0</span> 字符
                            </div>
                        </div>
                    </div>

                    <!-- 操作按钮 -->
                    <div class="mt-6 flex flex-wrap gap-4 justify-center">
                        <button id="process-btn" class="px-8 py-3 bg-primary text-white rounded-lg font-medium shadow-md hover:bg-primary/90 hover:shadow-lg transform hover:-translate-y-0.5 transition-all-300 flex items-center">
                            <i class="fa fa-exchange mr-2"></i>
                            <span id="process-btn-text">执行加密</span>
                        </button>
                        <button id="swap-btn" class="px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all-300 flex items-center">
                            <i class="fa fa-arrows-h mr-2"></i>
                            <span>交换内容</span>
                        </button>
                        <button id="save-btn" class="px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all-300 flex items-center">
                            <i class="fa fa-download mr-2"></i>
                            <span>保存结果</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- 算法说明 -->
            <div class="mt-10 bg-white rounded-2xl shadow-lg p-6 transition-all-300">
                <h3 class="text-xl font-bold mb-4 text-primary transition-all-300">算法说明</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="algorithm-info active" id="base64-info">
                        <h4 class="font-semibold text-lg mb-2">Base64</h4>
                        <p class="text-gray-600 transition-all-300">Base64是一种基于64个可打印字符来表示二进制数据的编码方式，常用于需要通过文本协议传输二进制数据的场景。它不是加密算法，而是一种编码方式。</p>
                    </div>
                    <div class="algorithm-info hidden" id="url-info">
                        <h4 class="font-semibold text-lg mb-2">URL编码</h4>
                        <p class="text-gray-600 transition-all-300">URL编码将字符转换为可以在URL中安全传输的格式，通常使用百分号(%)加上两位十六进制数表示特殊字符，确保URL的正确性和安全性。</p>
                    </div>
                    <div class="algorithm-info hidden" id="unicode-info">
                        <h4 class="font-semibold text-lg mb-2">Unicode</h4>
                        <p class="text-gray-600 transition-all-300">Unicode编码使用\u前缀加四位十六进制数表示字符，常用于在编程语言中表示特殊字符或非ASCII字符，确保字符在不同系统中的一致性。</p>
                    </div>
                    <div class="algorithm-info hidden" id="ascii-info">
                        <h4 class="font-semibold text-lg mb-2">ASCII</h4>
                        <p class="text-gray-600 transition-all-300">ASCII编码将字符转换为对应的ASCII数值，每个字符用十进制数表示，常用于需要将文本转换为数字表示的场景。</p>
                    </div>
                    <div class="algorithm-info hidden" id="rot13-info">
                        <h4 class="font-semibold text-lg mb-2">ROT13</h4>
                        <p class="text-gray-600 transition-all-300">ROT13是一种简单的替换加密，将字母表中的每个字母替换为其后第13个字母，A替换为N，B替换为O，以此类推。它是自身的逆运算，加密和解密使用相同的算法。</p>
                    </div>
                    <div class="algorithm-info hidden" id="html-info">
                        <h4 class="font-semibold text-lg mb-2">HTML实体</h4>
                        <p class="text-gray-600 transition-all-300">HTML实体编码将特殊字符转换为可以在HTML中安全显示的格式，通常使用&开头和;结尾的实体名称或编号，如&lt;表示小于号&lt;。</p>
                    </div>
                    <div class="algorithm-info hidden" id="hex-info">
                        <h4 class="font-semibold text-lg mb-2">十六进制</h4>
                        <p class="text-gray-600 transition-all-300">十六进制编码将字符转换为对应的十六进制数值，每个字符用0x前缀加两位十六进制数表示，常用于底层编程和数据表示。</p>
                    </div>
                    <div class="algorithm-info hidden" id="morse-info">
                        <h4 class="font-semibold text-lg mb-2">摩尔斯电码</h4>
                        <p class="text-gray-600 transition-all-300">摩尔斯电码是一种通过点(.)和划(-)表示字符的编码方式，最初用于电报通信，字符之间用空格分隔，单词之间用斜杠(/)分隔。</p>
                    </div>
                    <div class="algorithm-info hidden" id="md5-info">
                        <h4 class="font-semibold text-lg mb-2">MD5</h4>
                        <p class="text-gray-600 transition-all-300">MD5是一种广泛使用的哈希函数，产生128位（16字节）的哈希值，通常以32位十六进制数表示。MD5是不可逆的，主要用于校验数据完整性，不适合用于加密敏感信息。</p>
                    </div>
                    <div class="algorithm-info hidden" id="sha1-info">
                        <h4 class="font-semibold text-lg mb-2">SHA-1</h4>
                        <p class="text-gray-600 transition-all-300">SHA-1是一种 cryptographic哈希函数，产生160位（20字节）的哈希值，通常以40位十六进制数表示。虽然已被SHA-2系列取代，但仍在一些 legacy 系统中使用。</p>
                    </div>
                    <div class="algorithm-info hidden" id="sha256-info">
                        <h4 class="font-semibold text-lg mb-2">SHA-256</h4>
                        <p class="text-gray-600 transition-all-300">SHA-256是SHA-2系列哈希算法的一种，产生256位（32字节）的哈希值，通常以64位十六进制数表示。它比MD5更安全，不可逆，主要用于数据校验和密码存储。</p>
                    </div>
                    <div class="algorithm-info hidden" id="sha512-info">
                        <h4 class="font-semibold text-lg mb-2">SHA-512</h4>
                        <p class="text-gray-600 transition-all-300">SHA-512是SHA-2系列中安全性更高的哈希算法，产生512位（64字节）的哈希值，通常以128位十六进制数表示。适用于对安全性要求较高的场景。</p>
                    </div>
                    <div class="algorithm-info hidden" id="hmac-info">
                        <h4 class="font-semibold text-lg mb-2">HMAC</h4>
                        <p class="text-gray-600 transition-all-300">HMAC（基于哈希的消息认证码）是一种使用加密哈希函数和密钥来验证消息完整性和真实性的机制。本工具使用SHA-256作为基础哈希函数。</p>
                    </div>
                    <div class="algorithm-info hidden" id="aes-info">
                        <h4 class="font-semibold text-lg mb-2">AES</h4>
                        <p class="text-gray-600 transition-all-300">AES（高级加密标准）是一种对称加密算法，支持128位、192位和256位密钥长度。本工具使用128位密钥，需要相同的密钥进行加密和解密，是目前广泛使用的安全加密算法。</p>
                    </div>
                    <div class="algorithm-info hidden" id="des-info">
                        <h4 class="font-semibold text-lg mb-2">DES</h4>
                        <p class="text-gray-600 transition-all-300">DES（数据加密标准）是一种传统的对称加密算法，使用56位密钥。由于密钥长度较短，安全性较低，已逐渐被AES取代，但仍可用于兼容性场景。</p>
                    </div>
                    <div class="algorithm-info hidden" id="rc4-info">
                        <h4 class="font-semibold text-lg mb-2">RC4</h4>
                        <p class="text-gray-600 transition-all-300">RC4是一种流密码算法，通过生成伪随机流与明文进行异或运算来实现加密。虽然在某些场景仍有使用，但已知存在安全漏洞，不建议用于新系统。</p>
                    </div>
                    <div class="algorithm-info hidden" id="caesar-info">
                        <h4 class="font-semibold text-lg mb-2">凯撒密码</h4>
                        <p class="text-gray-600 transition-all-300">凯撒密码是一种简单的替换加密，通过将字母表中的每个字母按照固定数目（偏移量）向后（或向前）移位来实现加密。例如，偏移量为3时，A变为D，B变为E。</p>
                    </div>
                    <div class="algorithm-info hidden" id="affine-info">
                        <h4 class="font-semibold text-lg mb-2">仿射密码</h4>
                        <p class="text-gray-600 transition-all-300">仿射密码是一种单表代换密码，加密函数为：E(x) = (ax + b) mod m，其中a和b是密钥，m是字母表长度（通常为26）。a必须与m互质才能保证解密的唯一性。</p>
                    </div>
                    <div class="algorithm-info hidden" id="vigenere-info">
                        <h4 class="font-semibold text-lg mb-2">维吉尼亚密码</h4>
                        <p class="text-gray-600 transition-all-300">维吉尼亚密码是一种多表代换密码，使用关键词来确定每一位的偏移量。它是凯撒密码的扩展，安全性高于简单的单表替换密码，但仍属于古典密码范畴。</p>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- 页脚 -->
    <footer class="mt-16 bg-dark text-white py-10 transition-all-300">
        <div class="container mx-auto px-4">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0">
                    <div class="flex items-center space-x-2 mb-2">
                        <i class="fa fa-lock text-primary text-xl"></i>
                        <h2 class="text-xl font-bold">加密解密工具</h2>
                    </div>
                    <p class="text-gray-400 text-sm">保护您的信息安全</p>
                </div>
                <div class="flex space-x-6">
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-github text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-twitter text-xl"></i>
                    </a>
                    <a href="#" class="text-gray-400 hover:text-white transition-all-300">
                        <i class="fa fa-envelope text-xl"></i>
                    </a>
                </div>
            </div>
            <div class="mt-8 pt-6 border-t border-gray-700 text-center text-gray-400 text-sm">
                © 2023 加密解密工具 | 保护您的信息安全
            </div>
        </div>
    </footer>

    <!-- 通知提示 -->
    <div id="notification" class="fixed bottom-6 right-6 bg-dark text-white px-6 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all-300 flex items-center">
        <i class="fa fa-check-circle mr-2 text-green-400"></i>
        <span id="notification-text">操作成功</span>
    </div>

    <!-- 帮助模态框 -->
    <div id="help-modal" class="fixed inset-0 bg-black/50 z-50 flex items-center justify-center opacity-0 pointer-events-none transition-all-300">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto m-4 transform scale-95 transition-all-300">
            <div class="p-6 border-b">
                <div class="flex justify-between items-center">
                    <h3 class="text-xl font-bold text-primary">使用帮助</h3>
                    <button id="close-help" class="text-gray-500 hover:text-gray-700 transition-all-300">
                        <i class="fa fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="mb-6">
                    <h4 class="text-lg font-semibold mb-3">基本操作</h4>
                    <ul class="list-disc pl-5 space-y-2 text-gray-600">
                        <li>在输入框中输入需要加密或解密的文本</li>
                        <li>选择需要使用的加密算法</li>
                        <li>对于需要密钥的算法，请输入相应密钥或参数</li>
                        <li>点击"执行加密"或"执行解密"按钮进行操作</li>
                        <li>结果将显示在右侧的输出框中</li>
                    </ul>
                </div>
                
                <div class="mb-6">
                    <h4 class="text-lg font-semibold mb-3">功能按钮说明</h4>
                    <ul class="list-disc pl-5 space-y-2 text-gray-600">
                        <li><strong>交换内容</strong>：将输入框和输出框的内容互换</li>
                        <li><strong>保存结果</strong>：将输出框中的结果保存为文本文件</li>
                        <li><strong>复制</strong>：将输出框中的结果复制到剪贴板</li>
                        <li><strong>清空</strong>：清空输入框中的内容</li>
                        <li><strong>主题切换</strong>：切换明暗显示模式</li>
                    </ul>
                </div>
                
                <div class="mb-6">
                    <h4 class="text-lg font-semibold mb-3">算法分类说明</h4>
                    <div class="space-y-3">
                        <div>
                            <strong>编码格式</strong>：Base64、URL编码、Unicode、ASCII、HTML实体、十六进制等，主要用于数据格式转换，不提供安全性
                        </div>
                        <div>
                            <strong>哈希算法</strong>：MD5、SHA系列、HMAC，单向加密，用于数据完整性校验，不能解密
                        </div>
                        <div>
                            <strong>对称加密</strong>：AES、DES、RC4，使用相同密钥进行加密和解密，提供较高安全性
                        </div>
                        <div>
                            <strong>古典密码</strong>：凯撒密码、仿射密码、维吉尼亚密码等，主要用于教育和历史研究，安全性较低
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-semibold mb-3">常见问题</h4>
                    <div class="space-y-4 text-gray-600">
                        <div>
                            <strong>问：为什么有些算法没有解密功能？</strong>
                            <p class="mt-1">答：哈希算法（如MD5、SHA系列）是单向加密，设计上就是不可逆的，主要用于数据校验而非加密通信。</p>
                        </div>
                        <div>
                            <strong>问：如何选择合适的加密算法？</strong>
                            <p class="mt-1">答：日常数据转换使用编码格式；数据校验使用SHA-256或HMAC；敏感信息加密使用AES；古典密码仅用于学习和娱乐。</p>
                        </div>
                        <div>
                            <strong>问：所有操作都是在本地进行的吗？</strong>
                            <p class="mt-1">答：是的，所有加密解密操作都在您的浏览器本地进行，不会上传您的内容到服务器。</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // DOM元素
        const encryptBtn = document.getElementById('encrypt-btn');
        const decryptBtn = document.getElementById('decrypt-btn');
        const algorithmBtns = document.querySelectorAll('.algorithm-btn');
        const algorithmInfos = document.querySelectorAll('.algorithm-info');
        const inputText = document.getElementById('input-text');
        const outputText = document.getElementById('output-text');
        const processBtn = document.getElementById('process-btn');
        const processBtnText = document.getElementById('process-btn-text');
        const clearInputBtn = document.getElementById('clear-input');
        const copyOutputBtn = document.getElementById('copy-output');
        const swapBtn = document.getElementById('swap-btn');
        const saveBtn = document.getElementById('save-btn');
        const inputLength = document.getElementById('input-length');
        const outputLength = document.getElementById('output-length');
        const notification = document.getElementById('notification');
        const notificationText = document.getElementById('notification-text');
        const themeToggle = document.getElementById('theme-toggle');
        const helpBtn = document.getElementById('help-btn');
        const helpModal = document.getElementById('help-modal');
        const closeHelp = document.getElementById('close-help');
        const header = document.querySelector('header');
        const mainCards = document.querySelectorAll('.bg-white, .bg-dark');
        const paramsSection = document.getElementById('params-section');
        const singleParam = document.getElementById('single-param');
        const dualParams = document.getElementById('dual-params');
        const paramLabel = document.getElementById('param-label');
        const paramInput = document.getElementById('param-input');
        const param1Label = document.getElementById('param1-label');
        const param1Input = document.getElementById('param1-input');
        const param2Label = document.getElementById('param2-label');
        const param2Input = document.getElementById('param2-input');
        const paramHint = document.getElementById('param-hint');
        const toggleVisibility = document.getElementById('toggle-visibility');

        // 摩尔斯电码映射表
        const morseCodeMap = {
            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.', 'G': '--.', 'H': '....',
            'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..', 'M': '--', 'N': '-.', 'O': '---', 'P': '.--.',
            'Q': '--.-', 'R': '.-.', 'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
            'Y': '-.--', 'Z': '--..', '0': '-----', '1': '.----', '2': '..---', '3': '...--', '4': '....-',
            '5': '.....', '6': '-....', '7': '--...', '8': '---..', '9': '----.', '.': '.-.-.-', ',': '--..--',
            '?': '..--..', "'": '.----.', '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-', '&': '.-...',
            ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', '-': '-....-', '_': '..--.-', '"': '.-..-.',
            '$': '...-..-', '@': '.--.-.', ' ': '/'
        };

        // 状态变量
        let isEncryptMode = true;
        let currentAlgorithm = 'base64';
        let isDarkMode = false;
        let isParamVisible = false; // 用于控制密钥显示/隐藏

        // 初始化
        inputText.addEventListener('input', updateInputLength);
        outputText.addEventListener('input', updateOutputLength);
        helpBtn.addEventListener('click', openHelpModal);
        closeHelp.addEventListener('click', closeHelpModal);
        toggleVisibility.addEventListener('click', toggleParamVisibility);
        
        // 点击模态框外部关闭
        helpModal.addEventListener('click', (e) => {
            if (e.target === helpModal) {
                closeHelpModal();
            }
        });
        
        // 打开帮助模态框
        function openHelpModal() {
            helpModal.classList.remove('opacity-0', 'pointer-events-none');
            helpModal.querySelector('div').classList.remove('scale-95');
            helpModal.querySelector('div').classList.add('scale-100');
            document.body.style.overflow = 'hidden';
        }
        
        // 关闭帮助模态框
        function closeHelpModal() {
            helpModal.classList.add('opacity-0', 'pointer-events-none');
            helpModal.querySelector('div').classList.remove('scale-100');
            helpModal.querySelector('div').classList.add('scale-95');
            document.body.style.overflow = '';
        }

        // 切换密钥显示/隐藏
        function toggleParamVisibility() {
            isParamVisible = !isParamVisible;
            const icon = toggleVisibility.querySelector('i');
            
            if (isParamVisible) {
                paramInput.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                paramInput.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        }

        // 切换加密/解密模式
        encryptBtn.addEventListener('click', () => {
            isEncryptMode = true;
            encryptBtn.classList.add('text-primary', 'border-primary', 'border-b-2');
            encryptBtn.classList.remove('text-gray-500');
            decryptBtn.classList.remove('text-primary', 'border-primary', 'border-b-2');
            decryptBtn.classList.add('text-gray-500');
            processBtnText.textContent = '执行加密';
            
            // 对于哈希算法，解密模式不可用
            updateAlgorithmAvailability();
        });

        decryptBtn.addEventListener('click', () => {
            isEncryptMode = false;
            decryptBtn.classList.add('text-primary', 'border-primary', 'border-b-2');
            decryptBtn.classList.remove('text-gray-500');
            encryptBtn.classList.remove('text-primary', 'border-primary', 'border-b-2');
            encryptBtn.classList.add('text-gray-500');
            processBtnText.textContent = '执行解密';
            
            // 对于哈希算法，解密模式不可用
            updateAlgorithmAvailability();
        });

        // 计算最大公约数（用于仿射密码）
        function gcd(a, b) {
            while (b) {
                [a, b] = [b, a % b];
            }
            return a;
        }

        // 计算模逆（用于仿射密码解密）
        function modInverse(a, m) {
            // 确保a和m互质
            if (gcd(a, m) !== 1) {
                return null;
            }
            
            // 扩展欧几里得算法
            let m0 = m;
            let y = 0, x = 1;
            
            if (m === 1)
                return 0;
            
            while (a > 1) {
                let q = Math.floor(a / m);
                let t = m;
                
                m = a % m;
                a = t;
                t = y;
                
                y = x - q * y;
                x = t;
            }
            
            // 确保x为正数
            if (x < 0)
                x += m0;
            
            return x;
        }

        // 更新算法可用性（某些算法不支持解密）
        function updateAlgorithmAvailability() {
            const hashAlgorithms = ['md5', 'sha1', 'sha256', 'sha512', 'hmac'];
            
            if (isEncryptMode) {
                // 加密模式下所有算法可用
                algorithmBtns.forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('opacity-50', 'cursor-not-allowed');
                });
                
                // 如果当前选中的是哈希算法，允许操作
                processBtn.disabled = false;
                processBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                // 解密模式下哈希算法不可用
                algorithmBtns.forEach(btn => {
                    if (hashAlgorithms.includes(btn.dataset.algorithm)) {
                        btn.disabled = true;
                        btn.classList.add('opacity-50', 'cursor-not-allowed');
                    } else {
                        btn.disabled = false;
                        btn.classList.remove('opacity-50', 'cursor-not-allowed');
                    }
                });
                
                // 如果当前选中的是哈希算法，禁用处理按钮
                if (hashAlgorithms.includes(currentAlgorithm)) {
                    processBtn.disabled = true;
                    processBtn.classList.add('opacity-50', 'cursor-not-allowed');
                } else {
                    processBtn.disabled = false;
                    processBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                }
            }
        }

        // 切换算法
        algorithmBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // 如果是解密模式且点击的是哈希算法，则不切换
                if (!isEncryptMode && ['md5', 'sha1', 'sha256', 'sha512', 'hmac'].includes(btn.dataset.algorithm)) {
                    showNotification('哈希算法不支持解密操作');
                    return;
                }
                
                // 更新按钮样式
                algorithmBtns.forEach(b => {
                    b.classList.remove('active', 'border-primary', 'bg-primary/5', 'text-primary');
                    b.classList.add('border-gray-200', 'text-gray-700');
                });
                
                btn.classList.add('active', 'border-primary', 'bg-primary/5', 'text-primary');
                btn.classList.remove('border-gray-200', 'text-gray-700');
                
                // 更新当前算法
                currentAlgorithm = btn.dataset.algorithm;
                
                // 显示/隐藏参数输入区
                updateParamsSection();
                
                // 显示对应算法说明
                algorithmInfos.forEach(info => {
                    info.classList.add('hidden');
                    info.classList.remove('active');
                });
                
                const infoElement = document.getElementById(`${currentAlgorithm}-info`);
                if (infoElement) {
                    infoElement.classList.remove('hidden');
                    infoElement.classList.add('active');
                }
                
                // 更新按钮可用性
                updateAlgorithmAvailability();
            });
        });

        // 更新参数输入区显示
        function updateParamsSection() {
            // 重置参数区域
            paramsSection.classList.add('hidden');
            singleParam.classList.add('hidden');
            dualParams.classList.add('hidden');
            paramInput.value = '';
            param1Input.value = '';
            param2Input.value = '';
            
            // 需要单个参数的算法
            const singleParamAlgorithms = {
                'aes': {
                    label: '密钥:',
                    placeholder: '请输入AES密钥（至少8位）',
                    hint: 'AES加密需要密钥，加密和解密必须使用相同的密钥',
                    type: 'password'
                },
                'des': {
                    label: '密钥:',
                    placeholder: '请输入DES密钥（8位）',
                    hint: 'DES加密需要8位密钥，加密和解密必须使用相同的密钥',
                    type: 'password'
                },
                'rc4': {
                    label: '密钥:',
                    placeholder: '请输入RC4密钥',
                    hint: 'RC4加密需要密钥，长度没有严格限制，加密和解密必须使用相同的密钥',
                    type: 'password'
                },
                'caesar': {
                    label: '偏移量:',
                    placeholder: '请输入偏移量（默认3）',
                    hint: '凯撒密码的偏移量，整数，通常为3',
                    type: 'text',
                    defaultValue: '3'
                },
                'vigenere': {
                    label: '密钥词:',
                    placeholder: '请输入密钥词（仅字母）',
                    hint: '维吉尼亚密码的密钥词，由字母组成，决定每一位的偏移量',
                    type: 'text'
                },
                'hmac': {
                    label: '密钥:',
                    placeholder: '请输入HMAC密钥',
                    hint: 'HMAC需要密钥来生成消息认证码',
                    type: 'password'
                }
            };
            
            // 需要两个参数的算法
            const dualParamAlgorithms = {
                'affine': {
                    label1: '参数 A:',
                    placeholder1: '请输入参数A（1-25的质数）',
                    label2: '参数 B:',
                    placeholder2: '请输入参数B（0-25）',
                    hint: '仿射密码的两个参数，A必须与26互质（如3、5、7、9等）'
                }
            };
            
            // 显示单个参数区域
            if (singleParamAlgorithms[currentAlgorithm]) {
                const config = singleParamAlgorithms[currentAlgorithm];
                paramsSection.classList.remove('hidden');
                singleParam.classList.remove('hidden');
                
                paramLabel.textContent = config.label;
                paramInput.placeholder = config.placeholder;
                paramHint.textContent = config.hint;
                paramInput.type = config.type || 'text';
                
                if (config.defaultValue) {
                    paramInput.value = config.defaultValue;
                }
                
                // 更新可见性图标
                isParamVisible = config.type !== 'password';
                const icon = toggleVisibility.querySelector('i');
                if (isParamVisible) {
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                } else {
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                }
            }
            // 显示两个参数区域
            else if (dualParamAlgorithms[currentAlgorithm]) {
                const config = dualParamAlgorithms[currentAlgorithm];
                paramsSection.classList.remove('hidden');
                dualParams.classList.remove('hidden');
                
                param1Label.textContent = config.label1;
                param1Input.placeholder = config.placeholder1;
                param2Label.textContent = config.label2;
                param2Input.placeholder = config.placeholder2;
                paramHint.textContent = config.hint;
            }
        }

        // 处理输入文本长度显示
        function updateInputLength() {
            inputLength.textContent = inputText.value.length;
        }

        function updateOutputLength() {
            outputLength.textContent = outputText.value.length;
        }

        // 清空输入
        clearInputBtn.addEventListener('click', () => {
            inputText.value = '';
            updateInputLength();
            inputText.focus();
        });

        // 复制输出
        copyOutputBtn.addEventListener('click', () => {
            if (outputText.value) {
                outputText.select();
                document.execCommand('copy');
                showNotification('已复制到剪贴板');
            }
        });

        // 交换输入输出
        swapBtn.addEventListener('click', () => {
            const temp = inputText.value;
            inputText.value = outputText.value;
            outputText.value = temp;
            updateInputLength();
            updateOutputLength();
        });

        // 保存结果
        saveBtn.addEventListener('click', () => {
            if (outputText.value) {
                const blob = new Blob([outputText.value], { type: 'text/plain' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${isEncryptMode ? 'encrypted' : 'decrypted'}-${currentAlgorithm}.txt`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                showNotification('文件已保存');
            }
        });

        // 显示通知
        function showNotification(message) {
            notificationText.textContent = message;
            notification.classList.remove('translate-y-20', 'opacity-0');
            notification.classList.add('translate-y-0', 'opacity-100');
            
            setTimeout(() => {
                notification.classList.remove('translate-y-0', 'opacity-100');
                notification.classList.add('translate-y-20', 'opacity-0');
            }, 2000);
        }

        // 执行加密/解密
        processBtn.addEventListener('click', () => {
            const input = inputText.value;
            if (!input) return;
            
            try {
                // 验证参数
                if (['aes', 'des', 'rc4', 'caesar', 'vigenere', 'hmac'].includes(currentAlgorithm) && !paramInput.value) {
                    showNotification('请输入必要的参数或密钥');
                    paramInput.focus();
                    return;
                }
                
                if (currentAlgorithm === 'affine' && (!param1Input.value || !param2Input.value)) {
                    showNotification('请输入两个必要的参数');
                    param1Input.focus();
                    return;
                }
                
                // 特定算法的参数验证
                if (currentAlgorithm === 'aes' && paramInput.value.length < 8) {
                    showNotification('AES密钥长度至少为8位');
                    paramInput.focus();
                    return;
                }
                
                if (currentAlgorithm === 'des' && paramInput.value.length !== 8) {
                    showNotification('DES密钥长度必须为8位');
                    paramInput.focus();
                    return;
                }
                
                if (currentAlgorithm === 'caesar') {
                    const shift = parseInt(paramInput.value);
                    if (isNaN(shift)) {
                        showNotification('请输入有效的数字作为偏移量');
                        paramInput.focus();
                        return;
                    }
                }
                
                if (currentAlgorithm === 'affine') {
                    const a = parseInt(param1Input.value);
                    const b = parseInt(param2Input.value);
                    if (isNaN(a) || isNaN(b)) {
                        showNotification('请输入有效的数字作为参数');
                        param1Input.focus();
                        return;
                    }
                    if (a < 1 || a > 25 || b < 0 || b > 25) {
                        showNotification('参数A应在1-25之间，参数B应在0-25之间');
                        param1Input.focus();
                        return;
                    }
                    if (gcd(a, 26) !== 1) {
                        showNotification('参数A必须与26互质（如3、5、7、9等）');
                        param1Input.focus();
                        return;
                    }
                }
                
                if (currentAlgorithm === 'vigenere' && !/^[a-zA-Z]+$/.test(paramInput.value)) {
                    showNotification('维吉尼亚密码的密钥词只能包含字母');
                    paramInput.focus();
                    return;
                }
                
                let result;
                if (isEncryptMode) {
                    result = encrypt(input, currentAlgorithm);
                } else {
                    result = decrypt(input, currentAlgorithm);
                }
                outputText.value = result;
                updateOutputLength();
                
                // 添加动画效果
                processBtn.classList.add('scale-95');
                setTimeout(() => {
                    processBtn.classList.remove('scale-95');
                }, 150);
                
                showNotification(isEncryptMode ? '加密成功' : '解密成功');
            } catch (error) {
                showNotification(`操作失败: ${error.message}`);
                console.error(error);
            }
        });

        // 加密函数
        function encrypt(text, algorithm) {
            switch (algorithm) {
                case 'base64':
                    return btoa(unescape(encodeURIComponent(text)));
                case 'url':
                    return encodeURIComponent(text);
                case 'unicode':
                    return text.split('').map(char => '\\u' + ('000' + char.charCodeAt(0).toString(16)).slice(-4)).join('');
                case 'ascii':
                    return text.split('').map(char => char.charCodeAt(0)).join(' ');
                case 'rot13':
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        if (code >= 65 && code <= 90) {
                            return String.fromCharCode(((code - 65 + 13) % 26) + 65);
                        } else if (code >= 97 && code <= 122) {
                            return String.fromCharCode(((code - 97 + 13) % 26) + 97);
                        }
                        return char;
                    });
                case 'html':
                    return text.replace(/[&<>"']/g, char => {
                        const entities = {
                            '&': '&amp;',
                            '<': '&lt;',
                            '>': '&gt;',
                            '"': '&quot;',
                            "'": '&#39;'
                        };
                        return entities[char] || char;
                    });
                case 'hex':
                    return text.split('').map(char => '0x' + char.charCodeAt(0).toString(16).padStart(2, '0')).join(' ');
                case 'morse':
                    return text.toUpperCase().split('').map(char => {
                        return morseCodeMap[char] || char;
                    }).join(' ');
                case 'md5':
                    return CryptoJS.MD5(text).toString();
                case 'sha1':
                    return CryptoJS.SHA1(text).toString();
                case 'sha256':
                    return CryptoJS.SHA256(text).toString();
                case 'sha512':
                    return CryptoJS.SHA512(text).toString();
                case 'hmac':
                    return CryptoJS.HmacSHA256(text, paramInput.value).toString();
                case 'aes':
                    const aesKey = CryptoJS.enc.Utf8.parse(paramInput.value.padEnd(16, '0').substring(0, 16)); // 确保16位
                    const iv = CryptoJS.enc.Utf8.parse("0000000000000000"); // 初始向量
                    const encryptedAES = CryptoJS.AES.encrypt(text, aesKey, { 
                        iv: iv, 
                        mode: CryptoJS.mode.CBC, 
                        padding: CryptoJS.pad.Pkcs7 
                    });
                    return encryptedAES.toString();
                case 'des':
                    const desKey = CryptoJS.enc.Utf8.parse(paramInput.value.substring(0, 8)); // 确保8位
                    const encryptedDES = CryptoJS.DES.encrypt(text, desKey, { 
                        mode: CryptoJS.mode.ECB, 
                        padding: CryptoJS.pad.Pkcs7 
                    });
                    return encryptedDES.toString();
                case 'rc4':
                    const encryptedRC4 = CryptoJS.RC4.encrypt(text, paramInput.value);
                    return encryptedRC4.toString();
                case 'caesar':
                    const shift = parseInt(paramInput.value) || 3;
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        const isUpper = code >= 65 && code <= 90;
                        const base = isUpper ? 65 : 97;
                        return String.fromCharCode(((code - base + shift) % 26 + 26) % 26 + base);
                    });
                case 'affine': {
                    const a = parseInt(param1Input.value);
                    const b = parseInt(param2Input.value);
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        const isUpper = code >= 65 && code <= 90;
                        const base = isUpper ? 65 : 97;
                        const x = code - base;
                        const encryptedX = (a * x + b) % 26;
                        return String.fromCharCode(encryptedX + base);
                    });
                }
                case 'vigenere': {
                    const key = paramInput.value.toUpperCase();
                    let keyIndex = 0;
                    return text.replace(/[a-zA-Z]/g, char => {
                        const isUpper = char >= 'A' && char <= 'Z';
                        const base = isUpper ? 65 : 97;
                        const charCode = char.charCodeAt(0) - base;
                        const keyCode = key.charCodeAt(keyIndex % key.length) - 65; // 密钥始终用大写计算
                        keyIndex++;
                        const encryptedCode = (charCode + keyCode) % 26;
                        return String.fromCharCode(encryptedCode + base);
                    });
                }
                default:
                    throw new Error('不支持的加密算法');
            }
        }

        // 解密函数
        function decrypt(text, algorithm) {
            switch (algorithm) {
                case 'base64':
                    return decodeURIComponent(escape(atob(text)));
                case 'url':
                    return decodeURIComponent(text);
                case 'unicode':
                    return text.replace(/\\u([0-9a-fA-F]{4})/g, (match, hex) => String.fromCharCode(parseInt(hex, 16)));
                case 'ascii':
                    return text.split(' ').map(code => String.fromCharCode(code)).join('');
                case 'rot13':
                    // ROT13 加密和解密是同一个操作
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        if (code >= 65 && code <= 90) {
                            return String.fromCharCode(((code - 65 + 13) % 26) + 65);
                        } else if (code >= 97 && code <= 122) {
                            return String.fromCharCode(((code - 97 + 13) % 26) + 97);
                        }
                        return char;
                    });
                case 'html':
                    const el = document.createElement('textarea');
                    el.innerHTML = text;
                    return el.value;
                case 'hex':
                    return text.split(' ').map(hex => {
                        // 移除可能的0x前缀
                        const cleanHex = hex.startsWith('0x') ? hex.slice(2) : hex;
                        return String.fromCharCode(parseInt(cleanHex, 16));
                    }).join('');
                case 'morse':
                    // 创建反向映射表
                    const reverseMorseMap = {};
                    for (const [char, code] of Object.entries(morseCodeMap)) {
                        reverseMorseMap[code] = char;
                    }
                    
                    return text.split('   ').map(word => {
                        return word.split(' ').map(code => {
                            return reverseMorseMap[code] || code;
                        }).join('');
                    }).join(' ');
                case 'aes':
                    const aesKey = CryptoJS.enc.Utf8.parse(paramInput.value.padEnd(16, '0').substring(0, 16)); // 确保16位
                    const iv = CryptoJS.enc.Utf8.parse("0000000000000000"); // 初始向量
                    const decryptedAES = CryptoJS.AES.decrypt(text, aesKey, { 
                        iv: iv, 
                        mode: CryptoJS.mode.CBC, 
                        padding: CryptoJS.pad.Pkcs7 
                    });
                    return decryptedAES.toString(CryptoJS.enc.Utf8);
                case 'des':
                    const desKey = CryptoJS.enc.Utf8.parse(paramInput.value.substring(0, 8)); // 确保8位
                    const decryptedDES = CryptoJS.DES.decrypt(text, desKey, { 
                        mode: CryptoJS.mode.ECB, 
                        padding: CryptoJS.pad.Pkcs7 
                    });
                    return decryptedDES.toString(CryptoJS.enc.Utf8);
                case 'rc4':
                    const decryptedRC4 = CryptoJS.RC4.decrypt(text, paramInput.value);
                    return decryptedRC4.toString(CryptoJS.enc.Utf8);
                case 'caesar':
                    const shift = parseInt(paramInput.value) || 3;
                    // 解密是加密的逆过程，偏移量取负值
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        const isUpper = code >= 65 && code <= 90;
                        const base = isUpper ? 65 : 97;
                        return String.fromCharCode(((code - base - shift) % 26 + 26) % 26 + base);
                    });
                case 'affine': {
                    const a = parseInt(param1Input.value);
                    const b = parseInt(param2Input.value);
                    const aInverse = modInverse(a, 26);
                    
                    if (aInverse === null) {
                        throw new Error('参数A与26不互质，无法解密');
                    }
                    
                    return text.replace(/[a-zA-Z]/g, char => {
                        const code = char.charCodeAt(0);
                        const isUpper = code >= 65 && code <= 90;
                        const base = isUpper ? 65 : 97;
                        const y = code - base;
                        const decryptedX = (aInverse * (y - b + 26)) % 26; // +26确保为正数
                        return String.fromCharCode(decryptedX + base);
                    });
                }
                case 'vigenere': {
                    const key = paramInput.value.toUpperCase();
                    let keyIndex = 0;
                    return text.replace(/[a-zA-Z]/g, char => {
                        const isUpper = char >= 'A' && char <= 'Z';
                        const base = isUpper ? 65 : 97;
                        const charCode = char.charCodeAt(0) - base;
                        const keyCode = key.charCodeAt(keyIndex % key.length) - 65; // 密钥始终用大写计算
                        keyIndex++;
                        const decryptedCode = (charCode - keyCode + 26) % 26; // +26确保为正数
                        return String.fromCharCode(decryptedCode + base);
                    });
                }
                default:
                    throw new Error('不支持的解密算法');
            }
        }

        // 主题切换 - 完善版
        themeToggle.addEventListener('click', () => {
            isDarkMode = !isDarkMode;
            const icon = themeToggle.querySelector('i');
            
            // 更新主体背景和文字颜色
            document.body.classList.toggle('bg-gradient-to-br');
            document.body.classList.toggle('from-light');
            document.body.classList.toggle('to-blue-50');
            document.body.classList.toggle('bg-dark');
            document.body.classList.toggle('text-white');
            document.body.classList.toggle('text-dark');
            
            // 更新顶部导航栏样式
            header.classList.toggle('glass-effect');
            header.classList.toggle('glass-effect-dark');
            header.classList.toggle('border-blue-100');
            header.classList.toggle('border-gray-700');
            
            // 更新卡片背景
            mainCards.forEach(card => {
                card.classList.toggle('bg-white');
                card.classList.toggle('bg-gray-800');
            });
            
            // 更新按钮和交互元素
            document.querySelectorAll('.border-gray-200').forEach(el => {
                el.classList.toggle('border-gray-200');
                el.classList.toggle('border-gray-700');
            });
            
            document.querySelectorAll('.bg-gray-50').forEach(el => {
                el.classList.toggle('bg-gray-50');
                el.classList.toggle('bg-gray-700');
            });
            
            // 更新通知框
            notification.classList.toggle('bg-dark');
            notification.classList.toggle('bg-gray-800');
            
            // 更新图标
            if (isDarkMode) {
                icon.classList.remove('fa-moon-o', 'text-gray-600');
                icon.classList.add('fa-sun-o', 'text-yellow-400');
            } else {
                icon.classList.remove('fa-sun-o', 'text-yellow-400');
                icon.classList.add('fa-moon-o', 'text-gray-600');
            }
            
            // 更新帮助模态框
            const helpContent = helpModal.querySelector('.bg-white');
            if (helpContent) {
                helpContent.classList.toggle('bg-white');
                helpContent.classList.toggle('bg-gray-800');
                
                // 更新帮助模态框内文本颜色
                helpContent.querySelectorAll('p, li').forEach(el => {
                    el.classList.toggle('text-gray-600');
                    el.classList.toggle('text-gray-300');
                });
                
                // 更新帮助模态框内灰色背景元素
                helpContent.querySelectorAll('.bg-gray-50').forEach(el => {
                    el.classList.toggle('bg-gray-50');
                    el.classList.toggle('bg-gray-700');
                });
            }
            
            // 保存主题偏好
            localStorage.setItem('darkMode', isDarkMode);
        });

        // 检查保存的主题偏好
        function loadThemePreference() {
            const savedMode = localStorage.getItem('darkMode');
            if (savedMode === 'true') {
                themeToggle.click();
            }
        }

        // 初始化页面
        document.addEventListener('DOMContentLoaded', () => {
            const exampleText = "\u81ea\u5b9a\u4e49\u6253\u5370\u7eb8\u751f\u6210\u5668\uff0c\u514d\u8d39\u5728\u7ebf\u521b\u5efa\u548c\u6253\u5370\u81ea\u5b9a\u4e49\u7eb8\u5f20\uff0c\u652f\u6301\u6a2a\u7ebf\u7eb8\u3001\u65b9\u683c\u7eb8\u3001\u70b9\u9635\u7eb8\u7b49\u3002 paperme.luhui.net";
            inputText.value = exampleText;
            updateInputLength();
            
            // 初始化参数区域
            updateParamsSection();
            
            // 加载保存的主题偏好
            loadThemePreference();
        });
    </script>
</body>
</html>
    