鲁虺文本内容搜索展示系统 php版 Version1.0.3更新



取消固定文章数量，改为自动统计现有文章数

用户希望修改现有的 PHP 文章系统，取消固定的文章数量设置，改为自动统计现有文章的数量。我需要分析现有代码并进行相应修改。

首先，我需要找出系统中固定文章数量的地方：

原来的代码使用了$categoryMaxCounts数组来预设每个分类的文章数量
在加载文章时使用了这个预设值来限制加载范围

要实现自动统计，我需要：

删除$categoryMaxCounts相关的代码
实现一个函数来扫描每个分类目录，统计实际存在的文章数量
修改加载文章的逻辑，基于实际统计的数量来加载

具体修改点：

移除$categoryMaxCounts数组定义
创建countArticlesInCategory()函数，用于扫描目录并统计文章数量
修改getCategoryStats()函数，使用新的统计函数
修改getCategoryArticles()和getAllArticles()函数，使用实际统计的数量
调整分页和导航逻辑，基于实际文章数量

同时需要注意 PHP 5.6 的兼容性，继续使用兼容的语法。

现在我将编写修改后的代码：
自动统计文章数量的PHP文章系统
V1
创建时间：23:35
主要修改说明
本次修改实现了自动统计文章数量的功能，主要变更如下：

新增文章统计函数：
添加了countArticlesInCategory($category)函数，通过扫描指定分类目录中的.txt文件来统计实际文章数量
函数通过循环检查 1.txt、2.txt、3.txt... 的存在性来确定文章总数
移除固定数量配置：
删除了$categoryMaxCounts数组，不再使用预设的固定文章数量
所有涉及文章数量的地方均改为使用实际统计值
分类导航增强：
在分类导航链接旁显示该分类的文章数量（例如：诗词歌赋 (15)）
统计数据实时反映实际存在的文章数量
导航逻辑优化：
上一篇 / 下一篇按钮状态基于实际文章数量判断
分页逻辑根据实际文章数量动态调整
性能考虑：
限制单次加载的文章数量（最多 20 篇），避免大量文件操作影响性能
只在需要时进行目录扫描和文件检查

使用时，只需在各分类目录（category1、category2 等）中放置以数字命名的 txt 文件（1.txt、2.txt 等），系统会自动识别并统计文章数量，无需手动配置。







